<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Mind Map Generator</title>
    <meta name="description" content="AI-powered mind map generator for students - Create visual mind maps automatically">
    <meta name="author" content="Student Project">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Icon Components
        const Plus = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Trash2 = ({ size = 18 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        const Edit2 = ({ size = 18 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
        );

        const Save = ({ size = 18 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
        );

        const X = ({ size = 18 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const Sparkles = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 3v18M3 12h18M6.5 6.5l11 11M6.5 17.5l11-11"/>
            </svg>
        );

        // Main Component
        function MindMapGenerator() {
            const [topic, setTopic] = useState('');
            const [mindMap, setMindMap] = useState(null);
            const [editingNode, setEditingNode] = useState(null);
            const [editText, setEditText] = useState('');
            const [loading, setLoading] = useState(false);

            const generateMindMap = async () => {
                if (!topic.trim()) {
                    alert('Please enter a topic!');
                    return;
                }

                setLoading(true);

                try {
                    const response = await fetch("https://api.anthropic.com/v1/messages", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            model: "claude-sonnet-4-20250514",
                            max_tokens: 1000,
                            messages: [
                                {
                                    role: "user",
                                    content: `Create a mind map for the topic: "${topic}". 
                                    
                                    Return ONLY a JSON object (no markdown, no backticks, no explanation) with this exact structure:
                                    {
                                        "central": "main topic",
                                        "branches": [
                                            {
                                                "id": 1,
                                                "name": "Branch Name",
                                                "color": "bg-blue-100 border-blue-400",
                                                "children": ["sub-concept 1", "sub-concept 2", "sub-concept 3"]
                                            }
                                        ]
                                    }
                                    
                                    Generate 4-6 main branches with 3-5 sub-concepts each. Use these color combinations randomly:
                                    - bg-blue-100 border-blue-400
                                    - bg-green-100 border-green-400
                                    - bg-purple-100 border-purple-400
                                    - bg-pink-100 border-pink-400
                                    - bg-yellow-100 border-yellow-400
                                    - bg-indigo-100 border-indigo-400`
                                }
                            ],
                        })
                    });

                    const data = await response.json();
                    const textContent = data.content.find(item => item.type === "text")?.text || "";
                    
                    // Clean and parse the response
                    const cleanText = textContent.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                    const parsedMap = JSON.parse(cleanText);
                    
                    setMindMap(parsedMap);
                } catch (error) {
                    console.error('Error:', error);
                    alert('Failed to generate mind map. Please try again!');
                } finally {
                    setLoading(false);
                }
            };

            const addBranch = () => {
                const colors = [
                    'bg-blue-100 border-blue-400',
                    'bg-green-100 border-green-400',
                    'bg-purple-100 border-purple-400',
                    'bg-pink-100 border-pink-400',
                    'bg-yellow-100 border-yellow-400',
                    'bg-indigo-100 border-indigo-400'
                ];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                
                const newBranch = {
                    id: mindMap.branches.length + 1,
                    name: 'New Branch',
                    color: randomColor,
                    children: ['Sub-concept 1', 'Sub-concept 2']
                };
                setMindMap({
                    ...mindMap,
                    branches: [...mindMap.branches, newBranch]
                });
            };

            const deleteBranch = (id) => {
                setMindMap({
                    ...mindMap,
                    branches: mindMap.branches.filter(b => b.id !== id)
                });
            };

            const startEdit = (type, id, value, extra = {}) => {
                setEditingNode({ type, id, value, ...extra });
                setEditText(value);
            };

            const saveEdit = () => {
                if (editingNode.type === 'central') {
                    setMindMap({ ...mindMap, central: editText });
                } else if (editingNode.type === 'branch') {
                    const updated = mindMap.branches.map(b => 
                        b.id === editingNode.id ? { ...b, name: editText } : b
                    );
                    setMindMap({ ...mindMap, branches: updated });
                } else if (editingNode.type === 'child') {
                    const updated = mindMap.branches.map(b => {
                        if (b.id === editingNode.branchId) {
                            const newChildren = [...b.children];
                            newChildren[editingNode.childIndex] = editText;
                            return { ...b, children: newChildren };
                        }
                        return b;
                    });
                    setMindMap({ ...mindMap, branches: updated });
                }
                setEditingNode(null);
                setEditText('');
            };

            const addChild = (branchId) => {
                const updated = mindMap.branches.map(b => 
                    b.id === branchId ? { ...b, children: [...b.children, 'New sub-concept'] } : b
                );
                setMindMap({ ...mindMap, branches: updated });
            };

            const deleteChild = (branchId, childIndex) => {
                const updated = mindMap.branches.map(b => {
                    if (b.id === branchId) {
                        const newChildren = b.children.filter((_, i) => i !== childIndex);
                        return { ...b, children: newChildren };
                    }
                    return b;
                });
                setMindMap({ ...mindMap, branches: updated });
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-bold text-gray-800 mb-2">ðŸ§  AI Mind Map Generator</h1>
                            <p className="text-gray-600">Enter any topic and AI will automatically create a visual mind map</p>
                        </div>

                        <div className="bg-white rounded-lg shadow-md p-6 mb-8">
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                                Enter your topic:
                            </label>
                            <div className="flex gap-3">
                                <input
                                    type="text"
                                    value={topic}
                                    onChange={(e) => setTopic(e.target.value)}
                                    placeholder="e.g., Photosynthesis, World War 2, Machine Learning..."
                                    className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    onKeyPress={(e) => e.key === 'Enter' && !loading && generateMindMap()}
                                    disabled={loading}
                                />
                                <button
                                    onClick={generateMindMap}
                                    disabled={loading}
                                    className="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2"
                                >
                                    {loading ? (
                                        <>
                                            <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
                                            Generating...
                                        </>
                                    ) : (
                                        <>
                                            <Sparkles />
                                            Generate
                                        </>
                                    )}
                                </button>
                            </div>
                            <p className="text-xs text-gray-500 mt-2">âœ¨ Powered by Claude AI - generates intelligent mind maps automatically</p>
                        </div>

                        {mindMap && (
                            <div className="bg-white rounded-lg shadow-md p-8">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-xl font-semibold text-gray-800">Your Mind Map</h2>
                                    <button
                                        onClick={addBranch}
                                        className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"
                                    >
                                        <Plus />
                                        Add Branch
                                    </button>
                                </div>

                                <div className="relative">
                                    <div className="flex justify-center mb-12">
                                        {editingNode?.type === 'central' ? (
                                            <div className="flex items-center gap-2">
                                                <input
                                                    type="text"
                                                    value={editText}
                                                    onChange={(e) => setEditText(e.target.value)}
                                                    className="px-4 py-3 border-2 border-indigo-500 rounded-lg"
                                                    autoFocus
                                                />
                                                <button onClick={saveEdit} className="p-2 bg-green-500 text-white rounded">
                                                    <Save />
                                                </button>
                                                <button onClick={() => setEditingNode(null)} className="p-2 bg-gray-500 text-white rounded">
                                                    <X />
                                                </button>
                                            </div>
                                        ) : (
                                            <div className="relative">
                                                <div className="bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-4 rounded-full shadow-lg text-xl font-bold">
                                                    {mindMap.central}
                                                </div>
                                                <button
                                                    onClick={() => startEdit('central', null, mindMap.central)}
                                                    className="absolute -top-2 -right-2 p-1.5 bg-white rounded-full shadow-md hover:bg-gray-100"
                                                >
                                                    <Edit2 size={14} />
                                                </button>
                                            </div>
                                        )}
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        {mindMap.branches.map((branch) => (
                                            <div key={branch.id} className="relative">
                                                <div className={`${branch.color} border-2 rounded-lg p-4 shadow-md`}>
                                                    {editingNode?.type === 'branch' && editingNode?.id === branch.id ? (
                                                        <div className="flex items-center gap-2 mb-3">
                                                            <input
                                                                type="text"
                                                                value={editText}
                                                                onChange={(e) => setEditText(e.target.value)}
                                                                className="flex-1 px-2 py-1 border-2 border-gray-400 rounded"
                                                                autoFocus
                                                            />
                                                            <button onClick={saveEdit} className="p-1 bg-green-500 text-white rounded">
                                                                <Save size={14} />
                                                            </button>
                                                        </div>
                                                    ) : (
                                                        <div className="flex items-center justify-between mb-3">
                                                            <h3 className="font-bold text-lg text-gray-800">{branch.name}</h3>
                                                            <div className="flex gap-1">
                                                                <button
                                                                    onClick={() => startEdit('branch', branch.id, branch.name)}
                                                                    className="p-1.5 bg-white rounded hover:bg-gray-100"
                                                                >
                                                                    <Edit2 size={14} />
                                                                </button>
                                                                <button
                                                                    onClick={() => deleteBranch(branch.id)}
                                                                    className="p-1.5 bg-white rounded hover:bg-red-50"
                                                                >
                                                                    <Trash2 size={14} />
                                                                </button>
                                                            </div>
                                                        </div>
                                                    )}

                                                    <div className="space-y-2">
                                                        {branch.children.map((child, idx) => (
                                                            <div key={idx}>
                                                                {editingNode?.type === 'child' && 
                                                                 editingNode?.branchId === branch.id && 
                                                                 editingNode?.childIndex === idx ? (
                                                                    <div className="flex items-center gap-1">
                                                                        <input
                                                                            type="text"
                                                                            value={editText}
                                                                            onChange={(e) => setEditText(e.target.value)}
                                                                            className="flex-1 px-2 py-1 border border-gray-400 rounded text-sm"
                                                                            autoFocus
                                                                        />
                                                                        <button onClick={saveEdit} className="p-1 bg-green-500 text-white rounded">
                                                                            <Save size={12} />
                                                                        </button>
                                                                    </div>
                                                                ) : (
                                                                    <div className="flex items-center gap-2 bg-white bg-opacity-50 px-3 py-2 rounded">
                                                                        <span className="text-sm text-gray-700 flex-1">{child}</span>
                                                                        <button
                                                                            onClick={() => startEdit('child', null, child, { branchId: branch.id, childIndex: idx })}
                                                                            className="p-1 hover:bg-gray-200 rounded"
                                                                        >
                                                                            <Edit2 size={12} />
                                                                        </button>
                                                                        <button
                                                                            onClick={() => deleteChild(branch.id, idx)}
                                                                            className="p-1 hover:bg-red-100 rounded"
                                                                        >
                                                                            <Trash2 size={12} />
                                                                        </button>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        ))}
                                                        <button
                                                            onClick={() => addChild(branch.id)}
                                                            className="w-full py-1.5 text-sm text-gray-600 hover:bg-white hover:bg-opacity-50 rounded border border-dashed border-gray-400"
                                                        >
                                                            + Add sub-concept
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {!mindMap && !loading && (
                            <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-8 text-center">
                                <div className="text-6xl mb-4">ðŸŽ¯</div>
                                <h3 className="text-xl font-semibold text-gray-800 mb-2">Ready to Create Your Mind Map?</h3>
                                <p className="text-gray-600 mb-4">
                                    Just type any topic above and watch AI automatically generate a comprehensive mind map!
                                </p>
                                <div className="flex flex-wrap justify-center gap-2 text-sm">
                                    <span className="px-3 py-1 bg-white rounded-full text-gray-700 shadow-sm">Try: "Solar System"</span>
                                    <span className="px-3 py-1 bg-white rounded-full text-gray-700 shadow-sm">Try: "Healthy Diet"</span>
                                    <span className="px-3 py-1 bg-white rounded-full text-gray-700 shadow-sm">Try: "Business Strategy"</span>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<MindMapGenerator />, document.getElementById('root'));
    </script>
</body>
</html>